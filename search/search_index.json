{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Course website","text":""},{"location":"#teachers","title":"Teachers","text":"<ul> <li>Lea Taylor</li> <li>Stephanie Talker</li> <li>Lorenzo Raeli</li> </ul>"},{"location":"#material","title":"Material","text":"<ul> <li>This website</li> <li>Google doc (through mail)</li> </ul>"},{"location":"#learning-outcomes","title":"Learning outcomes","text":"<p>The participants can expect to know what kind of data they might receive,  how the data looks and potential pitfalls which might arise that are  specific to immunological problems. Furthermore, the participants will  have a base understanding of the expected cell types and their function  in these datasets as well as understand the complexity of the immune system.  Lastly, we will choose three cutting edge research topics to demonstrate  how the methods are used and how the challenges in the analysis present  themselves. </p>"},{"location":"#learning-experiences","title":"Learning experiences","text":"<p>To reach the learning outcomes we will use lectures, exercises, polls and group work. During exercises, you are free to discuss with other participants. During lectures, focus on the lecture only.</p>"},{"location":"#exercises","title":"Exercises","text":"<p>Each block has practical work involved. Some more than others. The practicals are subdivided into chapters, and we\u2019ll have a (short) discussion after each chapter. All answers to the practicals are incorporated, but they are hidden. Do the exercise first by yourself, before checking out the answer. If your answer is different from the answer in the practicals, try to figure out why they are different.</p>"},{"location":"#asking-questions","title":"Asking questions","text":"<p>During lectures, you are encouraged to raise your hand if you have questions. We will also provide a Google doc where questions can be asked.</p>"},{"location":"course_material/","title":"Course material","text":""},{"location":"course_material/#introduction-into-the-immune-system","title":"Introduction into the immune system","text":""},{"location":"course_material/#systems-immunology-embracing-the-complexity-of-the-immune-system","title":"Systems immunology \u2013 embracing the complexity of the immune system","text":"<p>Participents of the course can find the slides in the shared folder. </p>"},{"location":"course_material/#flow-cytometry-in-biomedical-research","title":"Flow cytometry in Biomedical Research","text":"<p>Participents of the course can find the slides in the shared folder. </p>"},{"location":"course_material/#methods-commonly-used-in-immunology","title":"Methods commonly used in immunology","text":""},{"location":"course_material/#current-research-topics-methods-and-problems","title":"Current research topics, methods, and problems","text":""},{"location":"course_material/#veterinary-and-comparative-immunology","title":"Veterinary and Comparative Immunology","text":"<p>Participents of the course can find the slides in the shared folder. </p>"},{"location":"course_schedule/","title":"Course schedule","text":"<p>Note</p> <p>Apart from the starting time the time schedule is indicative. Because we can not plan a course by the minute, in practice the time points will deviate. </p> start end topic 9:15 10:15 Introduction into the immune system 10:15 10:45 coffee 10:45 11:30 Systems immunology \u2013 embracing the complexity of the immune system 11:30 12:30 Flow cytometry in Biomedical Research 12:30 13:30 lunch 13:30 14:30 Methods commonly used in immunology and how to analyze the data 14:30 15:00 Hands on: Totalseq /Citeseq (1) 15:00 15:30 coffee 15:30 16:30 Hands on: Totalseq /Citeseq  (2) 16:30 16:50 Current research topics, their methods and problems 16:50 17:15 Veterinary and Comparative Immunology"},{"location":"hands_on/","title":"Hands-on","text":""},{"location":"hands_on/#preparation","title":"Preparation","text":"<p>Download the required files (found on the shared folder) to your computer in a project/course directory. </p>"},{"location":"hands_on/#exercise","title":"Exercise","text":"<p>We already ran cellranger multi to save some time</p> <p><pre><code>cellranger multi --id='SAMPLE' --csv='ProjectDir'/configs/'SAMPLE'.csv\n</code></pre> The config file for each sample looks like this:</p> <p><pre><code>[gene-expression]\nreference,/path_to_reference/refdata-cellranger-GRCh38-3.0.0\nexpect-cells,10000\n\n[feature]\nreference,/path_to_feature_file/feature_ref.csv\n\n[libraries]\nfastq_id,fastqs,lanes,feature_types,subsample_rate\n'SAMPLE'_SP,/path_to_raw_data,,Antibody Capture,\n'SAMPLE'_GX,/path_to_raw_data,,Gene Expression,\n</code></pre> feature_ref.csv file is set up in this manner:</p> <pre><code>id, name,read,pattern,sequence,feature_type\nCD69,CD69,R2,5PNNNNNNNNNN(BC)NNNNNNNNN,GTCTCTTGGCTTAAA,Antibody Capture\nCD8,CD8,R2,5PNNNNNNNNNN(BC)NNNNNNNNN,GCGCAACTTGATGAT,Antibody Capture\nCD4,CD4,R2,5PNNNNNNNNNN(BC)NNNNNNNNN,TGTTCCCGCTCAACT,Antibody Capture\nCD103,CD103,R2,5PNNNNNNNNNN(BC)NNNNNNNNN,GACCTCATTGTGAAT,Antibody Capture\n</code></pre> <p>Install the required packages \u201cSeurat\u201d and \u201cggplot2\u201d</p> Answer <pre><code>library(Seurat)\nlibrary(ggplot2)\n</code></pre>"},{"location":"hands_on/#lets-get-started","title":"Let\u2019s get started","text":"<p>Set an project directory as working directory and a create a folder for the results</p> Answer <pre><code>project_dir &lt;- \"Documents/immunology-in-bioinformatics-training/hands_on/\"\nsetwd(project_dir)\nout_folder &lt;- paste0(project_dir,\"results/\")\ndir.create(out_folder)\n</code></pre> <p>Run \u2018Read10X\u2019 in the folder containing the cellranger output</p> Answer <pre><code>i.data &lt;- Read10X(\"filtered_feature_bc_matrix/\")\n</code></pre> <p>Now we have a list with two elements. We split this list now into two elements.  First we will create a seurat object containing the gene expression date using \u2018CreateSeuratObject\u2019.  And second we will turn the CITE-seq data into a matrix using \u2018as.matrix\u2019.  Please save the resulting objects as \u2018.rds\u2019 files into the results directory.</p> Answer <pre><code>sc_data &lt;- CreateSeuratObject(counts=i.data$`Gene Expression`, min.cells=3, min.features=200)\nsaveRDS(sc_data, file=paste0(out_folder, \"seurat_gene_expression.rds\"))\n\nCITEseq_data &lt;- as.matrix(i.data$`Antibody Capture`)\nsaveRDS(CITEseq_data, file=paste0(out_folder, \"antibody_capture_matrix.rds\"))\n</code></pre> <p>We can look at the CITE-seq data with summary(t(CITEseq_data)). To get a normal distribution we will  take the log of the data. </p> Answer <pre><code>data_log &lt;- as.data.frame(apply(t(CITEseq_data),c(1,2),log))\n</code></pre> <p>We can plot the log-data using ggplot. Let\u2019s start with CD4 (The antibody is calles \u2018CD4.1\u2019) vs CD8.</p> Answer <pre><code>gg &lt;- ggplot(data_log, aes(x = CD4.1, y = CD8)) +\ngeom_bin2d(bins=200) + xlab(\"CD4\") + ylab(\"CD8\") +\nggtitle(\"CD4 vs. CD8 \")\nprint(gg)\n</code></pre> <p>There is a separation of CD4+ and CD4- cells at around 3.2. CD8 is a bit more complicated.  CD4+ cells look like they bound some CD8 antibody. Le\u2019t add some lines to the plot to split the cell populations.</p> Answer <pre><code>gg + \ngeom_vline(xintercept=3.2, linetype=\"dashed\", color = \"red\") +\ngeom_abline(intercept = 0, slope = 1, linetype=\"dashed\", color = \"red\") +\ngeom_hline(yintercept=3.2, linetype=\"dashed\", color = \"red\")\n</code></pre> <p>We can now split our cell into CD4 cells, CD8 cells, double-neg (DN) and douple-pos (DP) cells</p> Answer <pre><code>CD4 &lt;- data_log$CD4.1 &gt; 3.2 &amp; data_log$CD8 &lt;= data_log$CD4.1\nCD8 &lt;- data_log$CD4.1 &lt;= 3.2 &amp; data_log$CD8 &gt; 3.2\nDP &lt;- data_log$CD4.1 &gt; 3.2 &amp; data_log$CD8 &gt; data_log$CD4.1\nDN &lt;- data_log$CD4.1 &lt;= 3.2 &amp; data_log$CD8 &lt;= 3.2\n</code></pre> <p>Let\u2019s do the same with CD69 (Antibody is called CD69.1) and CD103.</p> Answer <p>```sh gg &lt;- ggplot(data_log[CD4,], aes(x = CD69.1, y = CD103)) + geom_bin2d(bins=200) + xlab(\u201cCD69.1\u201d) + ylab(\u201cCD103\u201d) + geom_vline(xintercept=2.6, linetype=\u201ddashed\u201d, color = \u201cred\u201d) + geom_hline(yintercept=3, linetype=\u201ddashed\u201d, color = \u201cred\u201d) + ggtitle(\u201cCD69 vs. CD103 \u201c) print(gg)</p> <p>CD69_CD103 &lt;- data_log$CD69.1 &gt; 2.6 &amp; data_log$CD103 &gt; 3 CD69 &lt;- data_log$CD69.1 &gt; 2.6 &amp; data_log$CD103 &lt;= 3 CD103 &lt;- data_log$CD69.1 &lt;= 2.6 &amp; data_log$CD103 &gt; 3 DN2 &lt;- data_log$CD69.1 &lt;= 2.6 &amp; data_log$CD103 &lt;= 3</p> <p>```</p> <p>We are now ready to create a lable for our cells. They all belong in two categories.  The first can be CD4/CD8/DN/DP and second CD69/CD103/DN/DP</p> Answer <pre><code>CITE_label &lt;- rep(NA,times= nrow(data_log))\nCITE_label[CD4] &lt;- \"CD4\"\nCITE_label[CD8] &lt;- \"CD8\"\nCITE_label[DP] &lt;- \"CD4_CD8\"\nCITE_label[DN] &lt;- \"DN\"\n\nCITE_label[CD69_CD103] &lt;- paste0(CITE_label[CD69_CD103],\"_CD69_CD103\")\nCITE_label[CD69] &lt;- paste0(CITE_label[CD69],\"_CD69\")\nCITE_label[CD103] &lt;- paste0(CITE_label[CD103],\"_CD103\")\nCITE_label[DN2] &lt;- paste0(CITE_label[DN2],\"_DN\")\n</code></pre> <p>We can look at the results with table. Furthermore we can add this labels to the \u201craw\u201d  CITE_Abs counts to add everything as metadata to our seurat object containing the expression data.</p> Answer <pre><code>table(CITE_label)\n\nfinal_CITE &lt;- cbind(t(CITEseq_data),CITE_label)\n\nseu &lt;- AddMetaData(sc_data, final_CITE)\n</code></pre>"},{"location":"precourse/","title":"Precourse preparations","text":""},{"location":"precourse/#technical","title":"Technical","text":"<p>You are required to bring your own laptop with a Wi-Fi connection, and the following software installed PRIOR to the course: R, R Studio. A list of packages will be provided in due time.</p>"},{"location":"precourse/#competencies","title":"Competencies","text":"<p>This course is designed for beginners in R. The competences and knowledge levels required correspond to those taught in courses such as: First Steps with R in Life Sciences or Introduction to statistics with R.</p> <p>Evaluate your R skills with the following self-assessment.</p>"},{"location":"precourse/#knowledge","title":"Knowledge","text":"<p>Introduction to flow cytometry:  Download the presentation</p> <p>Guide with review Questions:  Download the presentation</p> <p>Basic-Principles of FACS:  Download the presentation</p>"}]}